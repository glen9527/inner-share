<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/><meta name="exporter-version" content="Evernote Mac 7.8 (457453)"/><meta name="author" content="all_register@163.com"/><meta name="created" content="2018-06-22 09:22:20 +0000"/><meta name="source" content="desktop.mac"/><meta name="updated" content="2018-06-26 03:08:43 +0000"/><meta name="reminder-order" content="2018-06-22 09:42:00 +0000"/><meta name="reminder-done-time" content="2018-06-22 09:43:29 +0000"/><title>App 壳封装及 JS 交互</title></head><body><div><font style="font-size: 18px;"><span style="font-size: 18px; font-weight: bold;">基础环境准备：</span></font></div><ol><li><div><span style="font-size: 14px;">环境准备：安装 JDK并配置环境变量，安装 Android Studio (也有自带的 java 环境)</span></div></li><li><div><span style="font-size: 14px;">新建项目或者通过 Git 导入原项目 ( Project ) ，打开 app 模块( module )</span></div></li><li><div><span style="font-size: 14px;">自定义继承自系统 WebView 的类，设置基础属性</span></div></li><li><div><span style="font-size: 14px;">新建 Activity，在布局中放入 WebView</span></div></li><li><div><span style="font-size: 14px;">使用 WebView 的 loadUrl( url ) 方法，加载目标链接</span></div></li></ol><div><br/></div><div><br/></div><div><font style="font-size: 18px;"><span style="font-size: 18px; font-weight: bold;">依赖管理：</span></font></div><ol><li><div>Jar 包( aar 包)依赖：在 module gradle 文件 
<span style="font-size: 14px; color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">dependencies</span> 中，添加 
<span style="font-size: 14px; color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">compile fileTree</span><span style="font-size: 14px; color: rgb(25, 31, 37); font-family: &quot;.PingFang SC&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">(</span><span style="font-size: 14px; color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">include: </span><span style="font-size: 14px; color: rgb(25, 31, 37); font-family: &quot;.PingFang SC&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">[</span><span style="font-size: 14px; color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">'*.jar'</span><span style="font-size: 14px; color: rgb(25, 31, 37); font-family: &quot;.PingFang SC&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">],</span><span style="font-size: 14px; color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;"> dir: 'libs’</span><span style="font-size: 14px; color: rgb(25, 31, 37); font-family: &quot;.PingFang SC&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">)，</span><span style="font-size: 14px;">将所需 Jar 包放入 module 下 lib 文件夹内，然后 sync project with gradle files 让 jar 包可用；如果是 aar 包，需要额外</span><span style="font-size: 14px; -webkit-text-stroke-width: 0px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;.PingFang SC&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">在</span><span style="font-size: 14px; -webkit-text-stroke-width: 0px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;"> build.gradle </span><span style="font-size: 14px; -webkit-text-stroke-width: 0px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;.PingFang SC&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">添加</span><span style="font-size: 14px; -webkit-text-stroke-width: 0px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;"> repositories{flatDir{dirs 'libs’} 和</span><span style="font-size: 14px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;; font-stretch: normal; line-height: normal;"> </span><span style="font-size: 14px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;; font-stretch: normal; line-height: normal;"> dependencies{compile '</span><span style="font-size: 14px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;.PingFang SC&quot;; font-stretch: normal; line-height: normal;">包名</span><span style="font-size: 14px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;; font-stretch: normal; line-height: normal;">:</span><span style="font-size: 14px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;.PingFang SC&quot;; font-stretch: normal; line-height: normal;">类库名</span><span style="font-size: 14px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;; font-stretch: normal; line-height: normal;">:</span><span style="font-size: 14px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;.PingFang SC&quot;; font-stretch: normal; line-height: normal;">版本号</span><span style="font-size: 14px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;; font-stretch: normal; line-height: normal;">@aar'}</span></div></li><li><div>gradle 依赖：类似 maven 依赖管理，compile ‘groupId:artifactId:version’，例如 compile '
<span style="font-size: 14px; -webkit-text-stroke-width: 0px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">com.google.code.gson:gson:2.8.0</span>'</div></li><li><div>module 依赖: 在项目目录下 import module，并在主 module gradle 文件中添加  <span style="font-size: 14px; color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">compile project</span><span style="font-size: 14px; color: rgb(25, 31, 37); font-family: &quot;.PingFang SC&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">(</span><span style="font-size: 14px; color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">':moduleName’</span><span style="font-size: 14px; color: rgb(25, 31, 37); font-family: &quot;.PingFang SC&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">)，也可以手动将项目考到 project 根目录下，并手动在 setting.gradle 中 include module</span></div></li></ol><div><br/></div><div><br/></div><div><br/></div><div><font style="font-size: 18px;"><span style="font-size: 18px; font-weight: bold;">Js 调用 Android 原生方法：</span></font></div><ol><li><div>通过 <span style="font-size: 14px; color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;; font-stretch: normal; line-height: normal;">addJavascriptInterface 方式交互 - <span style="font-size: 14px; color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;; font-stretch: normal; line-height: normal; font-weight: bold;">推荐</span></span></div></li></ol><div>           首先，新建任意名称 Java 类，例如 JsNotify 类，内部任意定义 public 类型方法，并标注注解 @JavascriptInterface</div><div>           其次，给 WebView 
<span style="font-size: 14px; color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;; font-stretch: normal; line-height: normal;">addJavascriptInterface</span><span style="font-size: 14px; color: rgb(25, 31, 37); font-family: &quot;.PingFang SC&quot;; font-stretch: normal; line-height: normal;">(</span><span style="font-size: 14px; color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;; font-stretch: normal; line-height: normal;">new JsNotify</span><span style="font-size: 14px; color: rgb(25, 31, 37); font-family: &quot;.PingFang SC&quot;; font-stretch: normal; line-height: normal;">(),</span><span style="font-size: 14px; color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;; font-stretch: normal; line-height: normal;"> "javaObj”</span><span style="font-size: 14px; color: rgb(25, 31, 37); font-family: &quot;.PingFang SC&quot;; font-stretch: normal; line-height: normal;">); </span></div><div><span style="font-size: 14px; color: rgb(25, 31, 37); font-family: &quot;.PingFang SC&quot;; font-stretch: normal; line-height: normal;">         最后，Js 即可通过 javaObj 对象调用 JsNotify 类内带有 <span style="font-size: 14px; color: rgb(25, 31, 37); font-family: &quot;.PingFang SC&quot;; font-stretch: normal; line-height: normal;">@JavascriptInterface 注解的任意 public 方法</span></span></div><div><span style="font-size: 14px;"><span style="font-size: 14px; color: rgb(25, 31, 37); font-family: &quot;.PingFang SC&quot;; font-stretch: normal; line-height: normal;">         注意：Android 6.0 之后，需要动态申请权限，所以当调用的功能使用到敏感权限时，需要在原生方法里处理好申请权限逻辑，例如需要打开相机时，要申请相机权限，涉及到文件读写时要申请文件读写权限；</span></span></div><ol start="2"><li><div><span style="caret-color: rgb(25, 31, 37); color: rgb(25, 31, 37);">通过 WebViewClient 的 <span style="color: rgb(25, 31, 37);"
/><span style="font-size: 14px; -webkit-text-stroke-width: 0px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">shouldOverrideUrlLoading </span><span style="font-size: 14px; -webkit-text-stroke-width: 0px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;.PingFang SC&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">(webview, url) 回调拦截特征</span><span style="font-size: 14px; -webkit-text-stroke-width: 0px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;"> url</span></span></div></li></ol><div><span style="font-size: 14px; -webkit-text-stroke-color: rgb(25, 31, 37); caret-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;;">           通过解析 Uri，拦截符合特征的请求，处理完之后，如果 retrun true，即可终止原流程，return false 仍会走原加载流程</span></div><ol start="3"><li><div><span style="font-size: 14px; -webkit-text-stroke-width: 0px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;.PingFang SC&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">通过</span><span style="font-size: 14px; -webkit-text-stroke-width: 0px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;"> WebChromeClient </span><span style="font-size: 14px; -webkit-text-stroke-width: 0px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">onJsAlert</span><span style="font-size: 14px; -webkit-text-stroke-width: 0px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;.PingFang SC&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">()、</span><span style="font-size: 14px; -webkit-text-stroke-width: 0px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">onJsConfirm</span><span style="font-size: 14px; -webkit-text-stroke-width: 0px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;.PingFang SC&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">()、</span><span style="font-size: 14px; -webkit-text-stroke-width: 0px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">onJsPrompt()</span><span style="font-size: 14px; -webkit-text-stroke-width: 0px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;.PingFang SC&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">方法回调拦截 </span><span style="font-size: 14px; -webkit-text-stroke-width: 0px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">JS </span><span style="font-size: 14px; -webkit-text-stroke-width: 0px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;.PingFang SC&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">对话框消息</span></div></li></ol><div><span style="font-size: 14px; -webkit-text-stroke-color: rgb(25, 31, 37); caret-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;;">            通过解析 Uri，拦截符合特征的请求，处理完之后，如果 retrun true，即可终止原流程，return false 仍会走原加载流程</span></div><div><img src="App%20%E5%A3%B3%E5%B0%81%E8%A3%85%E5%8F%8A%20JS%20%E4%BA%A4%E4%BA%92.html.resources/C1454AD2-0B7D-45BC-99EF-0E76789BAA87.png" height="320" width="890"/><br/></div><div><br/></div><div><br/></div><div><br/></div><div><font color="#191f25" style="font-size: 18px;"><span style="caret-color: rgb(25, 31, 37);"><span style="font-size: 18px; color: rgb(25, 31, 37); font-weight: bold;">Android 调用 Js 方法：</span></span></font></div><ol><li><div><span style="caret-color: rgb(25, 31, 37); color: rgb(25, 31, 37);">通过 WebView 的 loadUrl( url ) 方法</span></div></li></ol><div><span style="color: rgb(25, 31, 37);">           加载目标页面，如果目标页面包含 callJS 的 js 方法，则可通过 </span><span style="color: rgb(25, 31, 37);"
/><span style="font-size: 14px; -webkit-text-stroke-width: 0px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">WebView.loadUrl</span><span style="font-size: 14px; -webkit-text-stroke-width: 0px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;.PingFang SC&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">(</span><span style="font-size: 14px; -webkit-text-stroke-width: 0px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">"javascript:callJS</span><span style="font-size: 14px; -webkit-text-stroke-width: 0px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;.PingFang SC&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">()</span><span style="caret-color: rgb(25, 31, 37); -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;; font-stretch: normal; line-height: normal;">”</span><span style="-webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-stretch: normal; line-height: normal;">) 方法调用；</span></div><div><span style="-webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-stretch: normal; line-height: normal;">           注意：<span style="color: rgb(25, 31, 37); font-stretch: normal; line-height: normal;"> </span><span style="font-size: 14px; -webkit-text-stroke-width: 0px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-stretch: normal; line-height: normal; font-family: &quot;Helvetica Neue&quot;; font-style: normal; font-variant-caps: normal; font-weight: normal;">JS</span><span style="font-size: 14px; -webkit-text-stroke-width: 0px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;; font-style: normal; font-variant-caps: normal; font-weight: normal;">代码调用一定要在</span><span style="font-size: 14px; -webkit-text-stroke-width: 0px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-stretch: normal; line-height: normal; font-family: &quot;Helvetica Neue&quot;; font-style: normal; font-variant-caps: normal; font-weight: normal;"> onPageFinished</span><span style="font-size: 14px; -webkit-text-stroke-width: 0px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;; font-style: normal; font-variant-caps: normal; font-weight: normal;">（）</span><span style="font-size: 14px; -webkit-text-stroke-width: 0px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-stretch: normal; line-height: normal; font-family: &quot;Helvetica Neue&quot;; font-style: normal; font-variant-caps: normal; font-weight: normal;"> </span><span style="font-size: 14px; -webkit-text-stroke-width: 0px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-stretch: normal; line-height: normal; font-family: &quot;.PingFang SC&quot;; font-style: normal; font-variant-caps: normal; font-weight: normal;">回调之后才能调用，否则不会生效。</span></span></div><ol start="2"><li><div><span style="caret-color: rgb(25, 31, 37); color: rgb(25, 31, 37);">通过 <span style="color: rgb(25, 31, 37);"
/><span style="font-size: 14px; -webkit-text-stroke-width: 0px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">WebView.evaluateJavascript</span><span style="font-size: 14px; -webkit-text-stroke-width: 0px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;.PingFang SC&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">（</span><span style="font-size: 14px; -webkit-text-stroke-width: 0px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">"javascript:callJS</span><span style="font-size: 14px; -webkit-text-stroke-width: 0px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;.PingFang SC&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">()</span><span style="font-size: 14px; -webkit-text-stroke-width: 0px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">"</span><span style="font-size: 14px; -webkit-text-stroke-width: 0px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;.PingFang SC&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;">,</span><span style="font-size: 14px; -webkit-text-stroke-width: 0px; -webkit-text-stroke-color: rgb(25, 31, 37); color: rgb(25, 31, 37); font-family: &quot;Helvetica Neue&quot;; font-stretch: normal; font-style: normal; font-variant-caps: normal; font-weight: normal; line-height: normal;"> valueCallBack）方法</span></span></div></li></ol><div><span style="color: rgb(25, 31, 37);">           使用方法及注意事项和第一种方式相同，可通过 valueCallBack 获取返回值</span></div><div><img src="App%20%E5%A3%B3%E5%B0%81%E8%A3%85%E5%8F%8A%20JS%20%E4%BA%A4%E4%BA%92.html.resources/6B6713D5-DD95-4A3C-9A9E-45ED05B3FF8D.png" height="240" width="760"/><br/></div><div><br/></div><div><br/></div><div><br/></div><div><font style="font-size: 18px;"><span style="font-size: 18px; font-weight: bold;">其他：</span></font></div><ol><li><div><span style="caret-color: rgb(25, 31, 37); color: rgb(25, 31, 37);">网络权限等基础权限处理</span></div></li><li><div><span style="caret-color: rgb(25, 31, 37); color: rgb(25, 31, 37);">目前雁阵审批项目使用的 WebView 内核是腾讯 X5 内核，使用方式和系统内核基本一致，如果使用过程中遇到问题，可以从 X5 内核的方向找些资料参考下</span></div></li><li><div><span style="caret-color: rgb(25, 31, 37); color: rgb(25, 31, 37);">关于通过 WebView 实现 Js 和 Android 原生方法交互的详细说明及实例，可以参考<a href="https://blog.csdn.net/carson_ho/article/details/64904691">这篇优秀博文</a></span></div></li></ol><div><br/></div><div><br/></div><div><span style="font-size: 18px; font-weight: bold;">问题：</span></div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(25, 31, 37); font-family: -apple-system, system-ui, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Segoe UI&quot;, system-ui, Roboto, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">1.安卓的开发环境搭建。安卓系统5.X时对应的打apk的包怎么打？ </span></div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(25, 31, 37); font-family: -apple-system, system-ui, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Segoe UI&quot;, system-ui, Roboto, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">    build-&gt;Generate signed apk，选择签名，最后一步 signature version 需同时勾选 v1 和 v2，v2 在 7.0 以下版本无法使用；打完包之后即可发布，也可加固后发布。</span></div><div><br/></div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(25, 31, 37); font-family: -apple-system, system-ui, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Segoe UI&quot;, system-ui, Roboto, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">2.打包代码的结构及其对应的含义？</span></div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(25, 31, 37); font-family: -apple-system, system-ui, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Segoe UI&quot;, system-ui, Roboto, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">    项目结构，参考项目</span></div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(25, 31, 37); font-family: -apple-system, system-ui, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Segoe UI&quot;, system-ui, Roboto, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">    apk 结构</span></div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(25, 31, 37); font-family: -apple-system, system-ui, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Segoe UI&quot;, system-ui, Roboto, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">         <img src="App%20%E5%A3%B3%E5%B0%81%E8%A3%85%E5%8F%8A%20JS%20%E4%BA%A4%E4%BA%92.html.resources/51032A9B-99B2-4058-8635-5C8B6007E517.png" height="364" width="552"/><br/></span></div><div><br/></div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(25, 31, 37); font-family: -apple-system, system-ui, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Segoe UI&quot;, system-ui, Roboto, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">3.打包时怎么更换url地址、图标？</span></div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(25, 31, 37); font-family: -apple-system, system-ui, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Segoe UI&quot;, system-ui, Roboto, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">    url 在常量类中，图标在 drawable 或者 mipmap 中，图标通过 manifest 文件 application 节点 icon 属性配置</span></div><div><br/></div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(25, 31, 37); font-family: -apple-system, system-ui, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Segoe UI&quot;, system-ui, Roboto, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">4.js调安卓原生代码的逻辑。比如、下拉刷新、导航条、调用相机、蓝牙、返回上页。退出保持登录状态。</span></div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(25, 31, 37); font-family: -apple-system, system-ui, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Segoe UI&quot;, system-ui, Roboto, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">    Android 系统没有提供默认下拉刷新、导航条等功能，需要自己实现</span></div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(25, 31, 37); font-family: -apple-system, system-ui, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Segoe UI&quot;, system-ui, Roboto, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">    打开蓝牙、相机等系统功能在回调里实现即可</span></div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(25, 31, 37); font-family: -apple-system, system-ui, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Segoe UI&quot;, system-ui, Roboto, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">    保持登录状态需要在 H5 登陆之后，将保持登录状态的 cookie 存储到本地，再次进入时由 WebView 管理</span></div><div><br/></div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(25, 31, 37); font-family: -apple-system, system-ui, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Segoe UI&quot;, system-ui, Roboto, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">5.安卓集成第三方的插件，比如、支持文档阅读。</span></div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(25, 31, 37); font-family: -apple-system, system-ui, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Segoe UI&quot;, system-ui, Roboto, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">    参考依赖管理，依赖相关组件即可；目前雁阵审批里，支持的PDF、word 等文档阅读使用的是 X5 的插件，由 WebView 内核自动管理</span></div><div><br/></div><div><span style="font-size: 14px; orphans: 2; white-space: pre-wrap; widows: 2; color: rgb(25, 31, 37); font-family: -apple-system, system-ui, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Segoe UI&quot;, system-ui, Roboto, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif;">6.开机即时启动应用的功能。--待实现 app设置为系统的launcher</span></div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(25, 31, 37); font-family: -apple-system, system-ui, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Segoe UI&quot;, system-ui, Roboto, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">    可以监听开机事件广播，但是目前主流机型已不支持该广播，很难实现开机自启</span></div><div><br/></div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(25, 31, 37); font-family: -apple-system, system-ui, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Segoe UI&quot;, system-ui, Roboto, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">7.自动获取拍照权限、拍照功能，压缩上传的功能。—待实现</span></div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(25, 31, 37); font-family: -apple-system, system-ui, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Segoe UI&quot;, system-ui, Roboto, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">    Android 6.0 以上需要动态申请权限，需要用户明确点击授权，6.0 之前只需在 manifest 清单文件中声明需要拍照权限即可；</span></div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: pre-wrap; widows: 2; word-spacing: 0px; color: rgb(25, 31, 37); font-family: -apple-system, system-ui, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Segoe UI&quot;, system-ui, Roboto, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">    拍照、裁剪图片可以使用系统应用，可以参考</span><a href="https://blog.csdn.net/gdutxiaoxu/article/details/53411790" style="font-size: 14px; font-family: -apple-system, system-ui, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Segoe UI&quot;, system-ui, Roboto, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">这里</a><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; -webkit-text-stroke-width: 0px; white-space: pre-wrap; widows: 2; word-spacing: 0px; color: rgb(25, 31, 37); font-family: -apple-system, system-ui, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Segoe UI&quot;, system-ui, Roboto, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">；</span></div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(25, 31, 37); font-family: -apple-system, system-ui, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Segoe UI&quot;, system-ui, Roboto, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">    压缩、上传需要自己实现</span></div><div><br/></div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(25, 31, 37); font-family: -apple-system, system-ui, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Segoe UI&quot;, system-ui, Roboto, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">8.集成第三方插件的步骤及方式</span></div><div><span style="font-size: 14px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; white-space: pre-wrap; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; color: rgb(25, 31, 37); font-family: -apple-system, system-ui, &quot;PingFang SC&quot;, &quot;Hiragino Sans GB&quot;, &quot;Segoe UI&quot;, system-ui, Roboto, &quot;Droid Sans&quot;, &quot;Helvetica Neue&quot;, sans-serif; font-variant-caps: normal; font-variant-ligatures: normal;">    参考依赖管理</span></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div><div><br/></div></body></html>